language: javascript
sudo: false

before_install:
  - rvm install 2.2.4

install:
  - npm install
  - gem install bundler
  - bundle install

before_script:
  # Install gulp cli to ensure gulp command can be run on travis CI
  - npm install -g gulp-cli

script: "gulp jekyll"


before_deploy:
  - git config --local user.name "Adam clone"
  - git config --local user.email "adam@grana.com"
  - git tag "$(date +'%Y%m%d')-$(git log --format=%h -1)"

deploy:
  - provider: pages
    skip_cleanup: true
    email: adam@grana.com
    name: Adam clone
    local_dir: docs
    github_token: $GITHUB_TOKEN
    on:
      branch: master
  - provider: releases
    api_key:
      secure: $GITHUB_TOKEN
    file_glob: true
    file: ./*
    skip_cleanup: true
    on:
      branch: M2-3012

env:
  global:
  - secure: E58lS5VReWbek5ioe36RC3KkZYpzPxs5JE8IH0EQMuhYbhk7dUuPBXAzrjkY1o/zxfzlYmt/kMG3e4uljbHMX/Ye4I0pSJg5RNRKSPG9LAt80TGETZLs1RdZOJwvhkUagl9t7P2diYJw2qkhDr9+yx6V+X5rGWJ3CmO1lTMXZk3rG2u+c42omud7+FodXr+OSFGFQm/qVeEbTH4/ue9ihhISwBnzQKO0i0qfcVahpFp0DMxd2NCyS4o5lwUPnZqkSokruvi8UJ5Zg13iOAkd7IDJcx/uA5RXh2iUYCgw+qBbOdyhLHHQ9Ptyc56re+MKaZ3W4h7RzbfVS5k8b559ft/2ddUf0sjAYZgSdYoYwPNcuLiJIysPf/7ck4Zl5s0VLHCNHXjotzXKblfoqcKuFidRsDdo9/cDxxAUAJRMnakNsmIVg/n/XjBJ6bGjm2y9m7z8x+7plq7j0GO3w63lSqwTvTEji43wvgyJLuQHM6V3sqjaGXj/EbklnzTOGqo6z8aGtcRKz9AiNvkugomVI/lRvAi4KKEmF5DjpkjmI1HBIactC8RCeHY4kQS+BWXVoxLflJMzx6g/8kCZt7G+vMK+9U/J1raNBV+HVMIv6EgYphcoPRsvu8H2+Gqjro6hKKbz478YhxQP1eJKNu3hCmfAUOLZRdLApw7LF8PDG00=
