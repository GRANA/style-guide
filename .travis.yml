language: javascript
sudo: false

before_install:
  - rvm install 2.2.4

install:
  - npm install
  - gem install bundler
  - bundle install

before_script:
  # Install gulp cli to ensure gulp command can be run on travis CI
  - npm install -g gulp-cli

script: "gulp jekyll"


before_deploy:
  - git config --local user.name "Adam clone"
  - git config --local user.email "adam@grana.com"
  - git tag "$(date +'%Y%m%d')-$(git log --format=%h -1)"

deploy:
  - provider: pages
    skip_cleanup: true
    email: adam@grana.com
    name: Adam clone
    local_dir: docs
    github_token: $GITHUB_TOKEN
    on:
      branch: master
  - provider: releases
    api_key:
      secure: $GITHUB_TOKEN
    file_glob: true
    file: ./*
    skip_cleanup: true
    on:
      branch: M2-3012

env:
  global:
    secure: "Co70fV5+0ibuuOKVKlh6jBslo1ZI6kIoZhZu21rx4yQ+w8wA9SfGtbSqsdGabdcrHnXac0DWjLxh9cKF044BQI8MaKv4qJRozB2JOBSf7AJhQAL6lZFUzkhSrmB7MBeimArJrM6SpcEpgIYT0yVRdvfgom//0NYxidn0VkTimm/lGsm8BVXYJt18+1dIEWzaplHqI4WVMx0gTWfNbpbOnL5EVpTyUiPzj3YYShW0VBrv6kghYgvi5n7Kbv3fhPOxUSbdLicCztSXqkK8t5G8CB4nWpojXb47KO3exYcoClMzJGpGpk+355L1QZWacV/EbJOpeBoVR8A+cIc4t+nygZPYJkCwuWBXP1SviWEuzCbdbtgOaPtH2BsYfxNJWq3y/d5eh7oDOBI/71DZFd6sGDPJSXW4lflg+KK4TU1SWYM4tQGGnB28Ixb1HMxiArC0TtXu6EdQdkoU3SVT6DapJIRcEWPb6xqDgOrL0QSJ5wy14+uruwvYAhCzI1QYWMBdb3VlvaIYUvSBXX8xddiIdof9eT71iWfIY9i2WNs6ImyM4Hpu/B51l96NCGT99p584geNrsZeN9JqtTHPQUMe/TMy5iHkZtji3C/JaTJ3oMijpzTyl6ZFF3fuJDxkYgX5vqon+R3SUiXHL6e8u/NcriWqBApA0KFJAhZmm01cwyo="
