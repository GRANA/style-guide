!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,i){var s={inputSelector:".field-dropdown",wrapperSelector:".field-group",inputValueAttr:"field-value",defaultItem:!1,inputName:null,onselect:function(){}};this.options=t.extend({},s,i),this.$el=e,this.input=this.options.inputSelector,this.wrapper=this.options.wrapperSelector,this.inputValAttr=this.options.inputValueAttr,this.defaultItem=this.options.defaultItem,this.isFocused=!1,this.$inputHidden=this.$el.find('input[name="'+this.options.inputName+'"]'),this.$listItems=this.$el.find(this.input+"-item"),this.$label=this.$el.find(this.input+"-label"),this.$scrollListContainer=this.$el.find(this.input+"-list-container"),this.$scrollList=this.$scrollListContainer.find(this.input+"-list"),this.init()}function i(e,i){var s={defaultItem:!1,onselect:function(){}};this.options=t.extend({},s,i),this.defaultItem=this.options.defaultItem,this.$el=e,this.$select=this.$el.find(".field-dropdown-select"),this.$label=this.$el.find(".field-dropdown-label"),this.init()}e.prototype={init:function(){var e=this;this.selectDefault(this.defaultItem),t(document).on("click",this.toggleAwayClick.bind(this)),this.$el.on("click",this.toggleList.bind(this)),this.$listItems.on("click",function(){e.selectItem(this)}),t(document).on("keypress",this.$el,this.onKeypress.bind(this))},toggleAwayClick:function(e){!t(e.target).closest(this.$el).length&&this.$el.hasClass("is-open")&&this.closeList()},toggleList:function(){this.$el.hasClass("is-open")?this.closeList():this.openList()},openList:function(){this.$el.addClass("is-open"),this.setFocus(),this.setItemPositionOnOpen()},closeList:function(){this.$el.removeClass("is-open"),this.removeFocus()},selectDefault:function(t){var e=!1;if(t&&(e=this.selectItemByValue(t)),!e){var i=this.$scrollList.find(".is-selected");if(i.length>0)this.switchLabel(i.html()),this.setHiddenInput(i[0]);else{var s=this.$listItems.first();this.selectItem(s[0])}}},selectItemByValue:function(t){var e=this.$el.find(this.input+"-item[data-"+this.inputValAttr+'="'+t+'"]');return e.length>0&&(this.selectItem(e[0]),!0)},selectItem:function(e){var i=t(e);if(!i.hasClass("is-selected")&&!i.hasClass("is-disabled")){var s=t(e).html();this.removeItemFocus(),this.swapSelected(e),this.switchLabel(s),this.setHiddenInput(e),this.options.onselect&&"function"==typeof this.options.onselect&&this.options.onselect(e)}},swapSelected:function(e){this.$el.find(".is-selected").removeClass("is-selected"),t(e).addClass("is-selected")},switchLabel:function(t){this.$label.html(t)},setHiddenInput:function(e){var i=t(e).data(this.inputValAttr);this.$inputHidden.val(i)},getNextItem:function(e){var i=this,s=this.isKeyFocused(e);if(s>-1){var n=this.$listItems.eq(s),l=this.$listItems.eq(s+1);l.length>0&&(this.getItemFirstLetter(l)!==e||n.hasClass("is-disabled")||(this.setItemPosition(l[0]),this.removeItemFocus(),l.addClass("is-focused")))}else this.$listItems.each(function(s){var n=t(this);if(i.getItemFirstLetter(n)===e&&!n.hasClass("is-disabled"))return i.setItemPosition(n[0]),i.removeItemFocus(),n.addClass("is-focused"),!1})},isKeyFocused:function(t){var e=this.$el.find(".is-focused");if(e.length>0){var i=e.html();if(this.getFirstLetter(i)===t)return e.index()}return-1},setItemPosition:function(e){var i=t(e),s=this.$scrollList.find(i).position().top;this.$scrollListContainer.scrollTop(s)},setItemPositionOnOpen:function(){var t=this.$el.find(".is-selected");t.length>0&&this.setItemPosition(t[0])},getFirstLetter:function(t){return t.charAt(0).toLowerCase()},getItemFirstLetter:function(t){var e=t.html();return this.getFirstLetter(e)},onKeypress:function(t){if(this.isFocused){var e=t.key;this.getNextItem(e)}},setFocus:function(){this.isFocused=!0},removeFocus:function(){this.isFocused=!1},removeItemFocus:function(){this.$el.find(".is-focused").removeClass("is-focused")}},i.prototype={init:function(){var e=this;this.selectDefault(this.defaultItem),t("body").on("change",this.$select,function(){var t=e.$el.find(":selected");e.selectItem(t)})},selectDefault:function(t){var e=!1;if(t&&(e=this.selectItemByValue(t)),!e){var i=this.$el.find(":selected");if(i.length>0)this.selectItem(i);else{var s=this.$el.find("option").first();this.selectItem(s)}}},selectItemByValue:function(t){var e=this.$el.find('option[value="'+t+'"]');return e.length>0&&(this.selectItem(e),!0)},selectItem:function(t){var e=t;e.prop("selected",!0),this.updateLabel(e.html()),this.options.onselect&&"function"==typeof this.options.onselect&&this.options.onselect(t)},updateLabel:function(t){this.$label.html(t)}},t.fn.fieldDropdown=function(t){return new e(this,t)},t.fn.fieldMobileDropdown=function(t){return new i(this,t)}});